<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.web.WebView?>
<?import javafx.scene.shape.SVGPath?>
<?import javafx.scene.effect.DropShadow?>

<BorderPane fx:id="rootPane" prefHeight="800.0" prefWidth="1200.0"
            styleClass="help-container"
            stylesheets="@../Styles/Common.css,@../Styles/Help.css"
            xmlns="http://javafx.com/javafx/8"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="org.example.Controllers.HelpController">
    <top>
        <!-- Header Section with Logo and Controls -->
        <VBox spacing="0">
            <HBox alignment="CENTER" spacing="20.0" styleClass="help-header">
                <children>
                    <HBox alignment="CENTER" spacing="15">
                        <StackPane styleClass="header-icon-container">
                            <SVGPath content="M12,3C7.03,3 3,7.03 3,12C3,16.97 7.03,21 12,21C16.97,21 21,16.97 21,12C21,7.03 16.97,3 12,3M12,19C8.13,19 5,15.87 5,12C5,8.13 8.13,5 12,5C15.87,5 19,8.13 19,12C19,15.87 15.87,19 12,19M11,17H13V11H11V17M11,9H13V7H11V9Z"
                                     fill="white" styleClass="header-icon-svg"/>
                        </StackPane>
                        <Label styleClass="header-label" text="Centre d'Aide - Auto-École Pro" />
                    </HBox>
                    <Region HBox.hgrow="ALWAYS"/>
                    <HBox spacing="12" alignment="CENTER">
                        <ToggleButton fx:id="darkModeToggle" styleClass="icon-button" text="Mode sombre"
                                      accessibleText="Activer/Désactiver le mode sombre">
                            <tooltip><Tooltip text="Activer/Désactiver le mode sombre"/></tooltip>
                            <graphic>
                                <SVGPath content="M20.84,4.22L19.06,5.11C18.29,4.3 17.28,3.71 16.17,3.42C12.89,2.5 9.46,4.23 8.54,7.51C7.63,10.79 9.36,14.22 12.64,15.13C15.92,16.05 19.35,14.32 20.27,11.04C20.57,9.92 20.54,8.75 20.18,7.67L21.82,6.72C22.21,8.19 22.23,9.83 21.73,11.45C20.5,15.69 16.07,18.06 11.83,16.83C7.59,15.61 5.22,11.17 6.44,6.93C7.67,2.69 12.1,0.32 16.34,1.54C18.06,2.06 19.55,3.07 20.64,4.44L20.84,4.22M12.97,7.62C12.67,7.55 12.36,7.5 12,7.5C10.07,7.5 8.5,9.07 8.5,11C8.5,12.93 10.07,14.5 12,14.5C12.36,14.5 12.67,14.45 12.97,14.38C11.93,14.18 11.07,13.39 10.76,12.38C10.46,11.38 10.78,10.3 11.53,9.63C11.95,9.26 12.47,9.03 12.97,7.62Z"
                                         fill="white" styleClass="button-icon-svg"/>
                            </graphic>
                        </ToggleButton>
                        <ComboBox fx:id="fontSizeComboBox" prefWidth="120" promptText="Taille du texte" />
                        <Button fx:id="printButton" styleClass="action-button" mnemonicParsing="false" text="Imprimer"
                                accessibleText="Imprimer la section actuelle">
                            <tooltip><Tooltip text="Imprimer la section actuelle (Ctrl+P)"/></tooltip>
                            <graphic>
                                <SVGPath content="M19,8H5V3H19M16,22H8V16H16M19,11H5A3,3 0 0,0 2,14V17H6V21H18V17H22V14A3,3 0 0,0 19,11Z"
                                         fill="white" styleClass="button-icon-svg"/>
                            </graphic>
                        </Button>
                        <Button fx:id="closeBtn" styleClass="close-button" mnemonicParsing="false" onAction="#handleClose"
                                text="Fermer" accessibleText="Fermer la fenêtre d'aide">
                            <tooltip><Tooltip text="Fermer la fenêtre d'aide (Esc)"/></tooltip>
                            <graphic>
                                <SVGPath content="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"
                                         fill="white" styleClass="button-icon-svg"/>
                            </graphic>
                        </Button>
                    </HBox>
                </children>
                <padding>
                    <Insets bottom="15.0" left="20.0" right="20.0" top="15.0"/>
                </padding>
                <effect>
                    <DropShadow color="#00000033" radius="5.0" spread="0.05" />
                </effect>
            </HBox>

            <!-- Enhanced Navigation Bar with Breadcrumbs -->
            <HBox alignment="CENTER_LEFT" spacing="10.0" styleClass="help-navbar">
                <children>
                    <Button fx:id="backButton" styleClass="nav-button" mnemonicParsing="false"
                            accessibleText="Retour">
                        <tooltip>
                            <Tooltip text="Retour (Alt+←)"/>
                        </tooltip>
                        <graphic>
                            <SVGPath content="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"
                                     fill="#1a365d" styleClass="nav-icon-svg"/>
                        </graphic>
                    </Button>
                    <Button fx:id="forwardButton" styleClass="nav-button" mnemonicParsing="false"
                            accessibleText="Suivant">
                        <tooltip>
                            <Tooltip text="Suivant (Alt+→)"/>
                        </tooltip>
                        <graphic>
                            <SVGPath content="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z"
                                     fill="#1a365d" styleClass="nav-icon-svg"/>
                        </graphic>
                    </Button>
                    <Button fx:id="homeButton" styleClass="nav-button" mnemonicParsing="false"
                            accessibleText="Accueil">
                        <tooltip>
                            <Tooltip text="Accueil (F1)"/>
                        </tooltip>
                        <graphic>
                            <SVGPath content="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"
                                     fill="#1a365d" styleClass="nav-icon-svg"/>
                        </graphic>
                    </Button>
                    <Separator orientation="VERTICAL" />
                    <HBox alignment="CENTER_LEFT" spacing="5">
                        <Label styleClass="breadcrumb-label">
                            <graphic>
                                <HBox alignment="CENTER" spacing="5">
                                    <SVGPath content="M3,4A2,2 0 0,0 1,6V17H3A3,3 0 0,0 6,20A3,3 0 0,0 9,17H15A3,3 0 0,0 18,20A3,3 0 0,0 21,17H23V12L20,8H17V4M10,6L14,10L10,14V11H4V9H10M17,9.5H19.5L21.47,12H17M6,15.5A1.5,1.5 0 0,1 7.5,17A1.5,1.5 0 0,1 6,18.5A1.5,1.5 0 0,1 4.5,17A1.5,1.5 0 0,1 6,15.5Z"
                                             fill="#4a5568" />
                                    <Label fx:id="breadcrumbLabel" styleClass="breadcrumb-label" text="Aide > Général > Introduction" />
                                </HBox>
                            </graphic>
                        </Label>
                    </HBox>
                    <Region HBox.hgrow="ALWAYS"/>
                    <HBox alignment="CENTER" spacing="5">
                        <TextField fx:id="searchField" promptText="Rechercher dans l'aide... (Ctrl+F)" prefWidth="250"
                                   accessibleText="Champ de recherche"/>
                        <Button fx:id="searchButton" styleClass="search-button" mnemonicParsing="false"
                                accessibleText="Rechercher">
                            <tooltip>
                                <Tooltip text="Rechercher"/>
                            </tooltip>
                            <graphic>
                                <SVGPath content="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"
                                         fill="white" styleClass="search-icon-svg"/>
                            </graphic>
                        </Button>
                    </HBox>
                </children>
                <padding>
                    <Insets bottom="10.0" left="20.0" right="20.0" top="10.0"/>
                </padding>
            </HBox>
        </VBox>
    </top>

    <center>
        <SplitPane dividerPositions="0.28" prefHeight="160.0" prefWidth="200.0" BorderPane.alignment="CENTER">
            <items>
                <!-- Left Panel - Enhanced Help Topics and Tabs -->
                <VBox styleClass="help-sidebar">
                    <TabPane fx:id="mainTabPane" tabClosingPolicy="UNAVAILABLE" styleClass="sidebar-tabs">
                        <tabs>
                            <Tab fx:id="contentTab" text="Contenu">
                                <content>
                                    <VBox spacing="10">
                                        <Accordion fx:id="helpAccordion" VBox.vgrow="ALWAYS">
                                            <panes>
                                                <TitledPane fx:id="generalSection" animated="true" text="Généralité">
                                                    <graphic>
                                                        <StackPane styleClass="section-icon-container">
                                                            <SVGPath content="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"
                                                                     fill="#1a365d" styleClass="section-icon-svg"/>
                                                        </StackPane>
                                                    </graphic>
                                                    <content>
                                                        <VBox spacing="8">
                                                            <Hyperlink text="Introduction" onAction="#handleGeneralLink" />
                                                            <Hyperlink text="Démarrage rapide" onAction="#handleGeneralLink" />
                                                            <Hyperlink text="Interface utilisateur" onAction="#handleGeneralLink" />
                                                            <Hyperlink text="Raccourcis Clavier" onAction="#handleGeneralLink" />
                                                        </VBox>
                                                    </content>
                                                </TitledPane>
                                                <TitledPane fx:id="candidatsSection" animated="true" text="Gestion des Candidats">
                                                    <graphic>
                                                        <StackPane styleClass="section-icon-container">
                                                            <SVGPath content="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"
                                                                     fill="#1a365d" styleClass="section-icon-svg"/>
                                                        </StackPane>
                                                    </graphic>
                                                    <content>
                                                        <VBox spacing="8">
                                                            <Hyperlink text="Ajouter un candidat" onAction="#handleCandidatsLink" />
                                                            <Hyperlink text="Modifier un candidat" onAction="#handleCandidatsLink" />
                                                            <Hyperlink text="Rechercher des candidats" onAction="#handleCandidatsLink" />
                                                            <Hyperlink text="Documents candidats" onAction="#handleCandidatsLink" />
                                                            <Hyperlink text="Tableau de bord Candidats" onAction="#handleCandidatsLink" />
                                                        </VBox>
                                                    </content>
                                                </TitledPane>
                                                <TitledPane fx:id="moniteursSection" animated="true" text="Gestion des Moniteurs">
                                                    <graphic>
                                                        <StackPane styleClass="section-icon-container">
                                                            <SVGPath content="M20,17A2,2 0 0,0 22,15V4A2,2 0 0,0 20,2H9.46C9.81,2.61 10,3.3 10,4H20V15H11V17M15,7V9H9V22H7V16H5V22H3V14H1.5V9A2,2 0 0,1 3.5,7H15M8,4A2,2 0 0,1 6,6A2,2 0 0,1 4,4A2,2 0 0,1 6,2A2,2 0 0,1 8,4Z"
                                                                     fill="#1a365d" styleClass="section-icon-svg"/>
                                                        </StackPane>
                                                    </graphic>
                                                    <content>
                                                        <VBox spacing="8">
                                                            <Hyperlink text="Ajouter un moniteur" onAction="#handleMoniteursLink" />
                                                            <Hyperlink text="Modifier un moniteur" onAction="#handleMoniteursLink" />
                                                            <Hyperlink text="Qualifications" onAction="#handleMoniteursLink" />
                                                            <Hyperlink text="Tableau de bord Moniteurs" onAction="#handleMoniteursLink" />
                                                        </VBox>
                                                    </content>
                                                </TitledPane>
                                                <TitledPane fx:id="vehiculesSection" animated="true" text="Gestion des Véhicules">
                                                    <graphic>
                                                        <StackPane styleClass="section-icon-container">
                                                            <SVGPath content="M18,18.5A1.5,1.5 0 0,1 16.5,17A1.5,1.5 0 0,1 18,15.5A1.5,1.5 0 0,1 19.5,17A1.5,1.5 0 0,1 18,18.5M19.5,9.5L21.46,12H17V9.5M6,18.5A1.5,1.5 0 0,1 4.5,17A1.5,1.5 0 0,1 6,15.5A1.5,1.5 0 0,1 7.5,17A1.5,1.5 0 0,1 6,18.5M20,8L23,12V17H21A3,3 0 0,1 18,20A3,3 0 0,1 15,17H9A3,3 0 0,1 6,20A3,3 0 0,1 3,17H1V6C1,4.89 1.89,4 3,4H17V8H20Z"
                                                                     fill="#1a365d" styleClass="section-icon-svg"/>
                                                        </StackPane>
                                                    </graphic>
                                                    <content>
                                                        <VBox spacing="8">
                                                            <Hyperlink text="Ajouter un véhicule" onAction="#handleVehiculesLink" />
                                                            <Hyperlink text="Maintenance" onAction="#handleVehiculesLink" />
                                                            <Hyperlink text="Assurances" onAction="#handleVehiculesLink" />
                                                        </VBox>
                                                    </content>
                                                </TitledPane>
                                                <TitledPane fx:id="examensSection" animated="true" text="Gestion des Examens">
                                                    <graphic>
                                                        <StackPane styleClass="section-icon-container">
                                                            <SVGPath content="M16,9H21.5L16,3.5V9M7,2H17L23,8V18A2,2 0 0,1 21,20H7C5.89,20 5,19.1 5,18V4A2,2 0 0,1 7,2M3,6V22H21V24H3A2,2 0 0,1 1,22V6H3Z"
                                                                     fill="#1a365d" styleClass="section-icon-svg"/>
                                                        </StackPane>
                                                    </graphic>
                                                    <content>
                                                        <VBox spacing="8">
                                                            <Hyperlink text="Planifier un examen" onAction="#handleExamensLink" />
                                                            <Hyperlink text="Résultats d'examen" onAction="#handleExamensLink" />
                                                            <Hyperlink text="Statistiques" onAction="#handleExamensLink" />
                                                            <Hyperlink text="Tableau de bord Examens" onAction="#handleExamensLink" />
                                                        </VBox>
                                                    </content>
                                                </TitledPane>
                                                <TitledPane fx:id="paiementsSection" animated="true" text="Gestion des Paiements">
                                                    <graphic>
                                                        <StackPane styleClass="section-icon-container">
                                                            <SVGPath content="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M11,17V16H9V14H13V13H10A1,1 0 0,1 9,12V9A1,1 0 0,1 10,8H11V7H13V8H15V10H11V11H14A1,1 0 0,1 15,12V15A1,1 0 0,1 14,16H13V17H11Z"
                                                                     fill="#1a365d" styleClass="section-icon-svg"/>
                                                        </StackPane>
                                                    </graphic>
                                                    <content>
                                                        <VBox spacing="8">
                                                            <Hyperlink text="Enregistrer un paiement" onAction="#handlePaiementsLink" />
                                                            <Hyperlink text="Factures et reçus" onAction="#handlePaiementsLink" />
                                                            <Hyperlink text="Rapports financiers" onAction="#handlePaiementsLink" />
                                                        </VBox>
                                                    </content>
                                                </TitledPane>
                                                <TitledPane fx:id="settingsSection" animated="true" text="Paramètres">
                                                    <graphic>
                                                        <StackPane styleClass="section-icon-container">
                                                            <SVGPath content="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"
                                                                     fill="#1a365d" styleClass="section-icon-svg"/>
                                                        </StackPane>
                                                    </graphic>
                                                    <content>
                                                        <VBox spacing="8">
                                                            <Hyperlink text="Paramètres généraux" onAction="#handleSettingsLink" />
                                                            <Hyperlink text="Utilisateurs et permissions" onAction="#handleSettingsLink" />
                                                            <Hyperlink text="Sauvegarde et restauration" onAction="#handleSettingsLink" />
                                                        </VBox>
                                                    </content>
                                                </TitledPane>
                                            </panes>
                                        </Accordion>
                                    </VBox>
                                </content>
                            </Tab>
                            <Tab fx:id="searchTab" text="Recherche">
                                <content>
                                    <VBox spacing="15">
                                        <padding>
                                            <Insets top="10" right="10" bottom="10" left="10" />
                                        </padding>
                                        <Label text="Résultats de recherche" styleClass="tab-header" />
                                        <ListView fx:id="searchResultsList" VBox.vgrow="ALWAYS" />
                                    </VBox>
                                </content>
                            </Tab>
                        </tabs>
                    </TabPane>
                </VBox>

                <!-- Right Panel - Enhanced Help Content with Card Layout -->
                <VBox styleClass="help-content">
                    <WebView fx:id="helpContentView" VBox.vgrow="ALWAYS" />
                </VBox>
            </items>
        </SplitPane>
    </center>

    <bottom>
        <!-- Enhanced Footer Section with Links and Info -->
        <HBox alignment="CENTER" spacing="20.0" styleClass="help-footer" BorderPane.alignment="CENTER">
            <children>
                <HBox spacing="15" alignment="CENTER_LEFT">
                    <Label fx:id="versionLabel" text="Version 1.3.0" />
                    <Separator orientation="VERTICAL" />
                    <Label fx:id="lastUpdatedLabel" text="Dernière mise à jour: 22/03/2025" />
                </HBox>
                <Region HBox.hgrow="ALWAYS"/>
                <HBox spacing="20.0" alignment="CENTER_RIGHT">
                    <children>
                        <Hyperlink fx:id="contactLink" text="Contact Support">
                            <graphic>
                                <SVGPath content="M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"
                                         fill="#1a365d" styleClass="favorite-icon-svg"/>
                            </graphic>
                        </Hyperlink>
                        <Separator orientation="VERTICAL" />
                        <Hyperlink fx:id="websiteLink" text="Site Web">
                            <graphic>
                                <SVGPath content="M16.36,14C16.44,13.34 16.5,12.68 16.5,12C16.5,11.32 16.44,10.66 16.36,10H19.74C19.9,10.64 20,11.31 20,12C20,12.69 19.9,13.36 19.74,14M14.59,19.56C15.19,18.45 15.65,17.25 15.97,16H18.92C17.96,17.65 16.43,18.93 14.59,19.56M14.34,14H9.66C9.56,13.34 9.5,12.68 9.5,12C9.5,11.32 9.56,10.65 9.66,10H14.34C14.43,10.65 14.5,11.32 14.5,12C14.5,12.68 14.43,13.34 14.34,14M12,19.96C11.17,18.76 10.5,17.43 10.09,16H13.91C13.5,17.43 12.83,18.76 12,19.96M8,8H5.08C6.03,6.34 7.57,5.06 9.4,4.44C8.8,5.55 8.35,6.75 8,8M5.08,16H8C8.35,17.25 8.8,18.45 9.4,19.56C7.57,18.93 6.03,17.65 5.08,16M4.26,14C4.1,13.36 4,12.69 4,12C4,11.31 4.1,10.64 4.26,10H7.64C7.56,10.66 7.5,11.32 7.5,12C7.5,12.68 7.56,13.34 7.64,14M12,4.03C12.83,5.23 13.5,6.57 13.91,8H10.09C10.5,6.57 11.17,5.23 12,4.03M18.92,8H15.97C15.65,6.75 15.19,5.55 14.59,4.44C16.43,5.07 17.96,6.34 18.92,8M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"
                                         fill="#1a365d" styleClass="favorite-icon-svg"/>
                            </graphic>
                        </Hyperlink>
                    </children>
                </HBox>
            </children>
            <padding>
                <Insets bottom="12.0" left="20.0" right="20.0" top="12.0"/>
            </padding>
        </HBox>
    </bottom>
</BorderPane>