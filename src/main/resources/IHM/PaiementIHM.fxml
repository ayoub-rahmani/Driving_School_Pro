<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.*?>

<BorderPane prefHeight="900.0" prefWidth="1600.0" styleClass="paiement-container" stylesheets="@../Styles/Common.css,@../Styles/Paiement.css" xmlns="http://javafx.com/javafx/17.0.2-ea" xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.example.Controllers.PaiementController">
    <top>
        <!-- Header Section -->
        <HBox alignment="CENTER" spacing="20.0" styleClass="header" BorderPane.alignment="CENTER">
            <children>
                <!-- Back Button -->
                <Button fx:id="backBtn" mnemonicParsing="false" onAction="#handleBack" styleClass="icon-button">
                    <tooltip>
                        <Tooltip text="Retour" />
                    </tooltip>
                    <graphic>
                        <SVGPath content="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" fill="white" scaleX="1.2" scaleY="1.2" />
                    </graphic>
                </Button>

                <Region HBox.hgrow="ALWAYS" />

                <!-- Logo and Title -->
                <StackPane styleClass="logo-container">
                    <SVGPath content="M5,6H23V18H5V6M14,9A3,3 0 0,1 17,12A3,3 0 0,1 14,15A3,3 0 0,1 11,12A3,3 0 0,1 14,9M9,8A2,2 0 0,1 7,10V14A2,2 0 0,1 9,16H19A2,2 0 0,1 21,14V10A2,2 0 0,1 19,8H9M1,10H3V20H19V22H1V10Z" fill="brown" scaleX="1.5" scaleY="1.5" />
                </StackPane>
                <Label styleClass="header-label" text="GESTION DES PAIEMENTS" />

                <Region HBox.hgrow="ALWAYS" />

                <!-- Refresh Button -->
                <Button fx:id="refreshBtn" mnemonicParsing="false" onAction="#handleRefresh"
                        styleClass="icon-button">
                    <tooltip>
                        <Tooltip text="Actualiser"/>
                    </tooltip>
                    <graphic>
                        <SVGPath content="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"
                                 fill="white" scaleX="1.2" scaleY="1.2"/>
                    </graphic>
                </Button>


                <!-- Settings Button -->
                <Button fx:id="settingsBtn" mnemonicParsing="false" onAction="#handleSettings" styleClass="icon-button">
                    <tooltip>
                        <Tooltip text="Paramètres" />
                    </tooltip>
                    <graphic>
                        <SVGPath content="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" fill="white" scaleX="1.2" scaleY="1.2" />
                    </graphic>
                </Button>

                <!-- Help Button -->
                <Button fx:id="helpBtn" mnemonicParsing="false" onAction="#handleHelp" styleClass="icon-button">
                    <tooltip>
                        <Tooltip text="Aide" />
                    </tooltip>
                    <graphic>
                        <SVGPath content="M11,18H13V16H11V18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,6A4,4 0 0,0 8,10H10A2,2 0 0,1 12,8A2,2 0 0,1 14,10C14,12 11,11.75 11,15H13C13,12.75 16,12.5 16,10A4,4 0 0,0 12,6Z" fill="white" scaleX="1.2" scaleY="1.2" />
                    </graphic>
                </Button>
            </children>
            <padding>
                <Insets bottom="15.0" left="20.0" right="20.0" top="15.0" />
            </padding>
        </HBox>
    </top>

    <center>
        <StackPane>
            <children>
                <TabPane fx:id="mainTabPane" prefHeight="700.0" styleClass="main-tab-pane" tabClosingPolicy="UNAVAILABLE">
                    <tabs>
                        <!-- Paiement Tab -->
                        <Tab fx:id="paiementTab" text="Paiements">
                            <content>
                                <BorderPane>
                                    <left>
                                        <StackPane>
                                            <children>

                                                <!-- Left Panel with Table and Actions -->
                                                <ScrollPane fitToHeight="true" fitToWidth="true" styleClass="left-panel-scroll" hbarPolicy="NEVER" vbarPolicy="AS_NEEDED">
                                                    <content>
                                                        <VBox prefHeight="600" prefWidth="450.0" spacing="15.0" styleClass="paiement-table-container">
                                                            <children>
                                                                <!-- Search Bar -->
                                                                <HBox alignment="CENTER_LEFT" spacing="15.0">
                                                                    <children>
                                                                        <TextField fx:id="paiementRechercheField" promptText="Rechercher par candidat, méthode, référence..." styleClass="search-box" HBox.hgrow="ALWAYS" onKeyReleased="#handleRecherche" />
                                                                        <Button fx:id="paiementRechercheBtn" mnemonicParsing="false" onAction="#handleRecherche" styleClass="icon-button">
                                                                            <tooltip>
                                                                                <Tooltip text="Rechercher" />
                                                                            </tooltip>
                                                                            <graphic>
                                                                                <SVGPath content="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" fill="#2563eb" />
                                                                            </graphic>
                                                                        </Button>
                                                                    </children>
                                                                </HBox>

                                                                <!-- Filters TitledPane -->
                                                                <TitledPane animated="true" expanded="false" styleClass="filter-titled-pane" text="Filtres">
                                                                    <content>
                                                                        <VBox spacing="15" styleClass="filter-section">
                                                                            <children>
                                                                                <!-- Methode Paiement Filter -->
                                                                                <HBox alignment="CENTER_LEFT" spacing="15.0">
                                                                                    <children>
                                                                                        <Label styleClass="filter-label" text="Méthode de paiement:" />
                                                                                        <ComboBox fx:id="filterMethodePaiementComboBox" prefWidth="200.0" styleClass="combo-box-large" />
                                                                                    </children>
                                                                                </HBox>

                                                                                <!-- Statut Filter -->
                                                                                <HBox alignment="CENTER_LEFT" spacing="15.0">
                                                                                    <children>
                                                                                        <Label styleClass="filter-label" text="Statut:" />
                                                                                        <ComboBox fx:id="filterStatutComboBox" prefWidth="200.0" styleClass="combo-box-large" />
                                                                                    </children>
                                                                                </HBox>

                                                                                <!-- Candidat Filter -->
                                                                                <HBox alignment="CENTER_LEFT" spacing="15.0">
                                                                                    <children>
                                                                                        <Label styleClass="filter-label" text="Candidat:" />
                                                                                        <ComboBox fx:id="filterCandidatComboBox" prefWidth="200.0" styleClass="combo-box-large" />
                                                                                    </children>
                                                                                </HBox>

                                                                                <!-- Date Range Filter -->
                                                                                <HBox alignment="CENTER_LEFT" spacing="15.0">
                                                                                    <children>
                                                                                        <Label styleClass="filter-label" text="Période:" />
                                                                                        <DatePicker fx:id="startDatePicker" promptText="Début" styleClass="date-picker-large" />
                                                                                        <Label text="à" />
                                                                                        <DatePicker fx:id="endDatePicker" promptText="Fin" styleClass="date-picker-large" />
                                                                                    </children>
                                                                                </HBox>

                                                                                <!-- Apply and Reset Buttons -->
                                                                                <HBox alignment="CENTER" spacing="20.0">
                                                                                    <children>
                                                                                        <Button fx:id="applyFilterBtn" mnemonicParsing="false" onAction="#handleApplyFilter" styleClass="button, button-primary" text="Appliquer" />
                                                                                        <Button fx:id="resetFilterBtn" mnemonicParsing="false" onAction="#handleResetFilter" styleClass="button, button-secondary" text="Réinitialiser" />
                                                                                    </children>
                                                                                </HBox>
                                                                            </children>
                                                                            <padding>
                                                                                <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                                                                            </padding>
                                                                        </VBox>
                                                                    </content>
                                                                </TitledPane>

                                                                <!-- Paiement Table -->
                                                                <TableView fx:id="paiementTable" prefHeight="350.0" styleClass="table-view-large">
                                                                    <columns>
                                                                        <TableColumn fx:id="paiementIdColumn" prefWidth="50.0" text="ID" />
                                                                        <TableColumn fx:id="candidatNameColumn" prefWidth="120.0" text="Candidat" />
                                                                        <TableColumn fx:id="datePaiementColumn" prefWidth="80.0" text="Date" />
                                                                        <TableColumn fx:id="montantColumn" prefWidth="80.0" text="Montant" />
                                                                        <TableColumn fx:id="methodePaiementColumn" prefWidth="80.0" text="Méthode" />
                                                                        <TableColumn fx:id="referenceColumn" prefWidth="100.0" text="Référence" />
                                                                        <TableColumn fx:id="statutColumn" prefWidth="80.0" text="Statut" />
                                                                    </columns>
                                                                    <placeholder>
                                                                        <Label styleClass="placeholder-label" text="Aucun paiement trouvé" />
                                                                    </placeholder>
                                                                </TableView>

                                                                <!-- Action Buttons -->
                                                                <HBox alignment="CENTER" spacing="10.0">
                                                                    <children>
                                                                        <Button fx:id="paiementAjouterBtn" mnemonicParsing="false" onAction="#handleAjouter" styleClass="button, button-success" text="Ajouter">
                                                                            <graphic>
                                                                                <SVGPath content="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" fill="white" />
                                                                            </graphic>
                                                                        </Button>
                                                                        <Button fx:id="paiementModifierBtn" mnemonicParsing="false" onAction="#handleModifier" styleClass="button, button-warning" text="Modifier">
                                                                            <graphic>
                                                                                <SVGPath content="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" fill="white" />
                                                                            </graphic>
                                                                        </Button>
                                                                        <Button fx:id="paiementSupprimerBtn" mnemonicParsing="false" onAction="#handleSupprimer" styleClass="button, button-danger" text="Supprimer">
                                                                            <graphic>
                                                                                <SVGPath content="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" fill="white" />
                                                                            </graphic>
                                                                        </Button>
                                                                        <Button fx:id="paiementExportBtn" mnemonicParsing="false" onAction="#handleExportPaiements" styleClass="button, button-info" text="Exporter">
                                                                            <graphic>
                                                                                <SVGPath content="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M10,19L12,15H9V10H15V15H12L14,19H10Z" fill="white" />
                                                                            </graphic>
                                                                        </Button>
                                                                    </children>
                                                                </HBox>
                                                                <HBox alignment="CENTER" spacing="10.0">
                                                                    <children>
                                                                        <Button fx:id="generatePaiementPdfBtn" maxWidth="Infinity" mnemonicParsing="false" onAction="#handleGeneratePaiementPdf" styleClass="button, button-primary" text="Générer PDF" HBox.hgrow="ALWAYS">
                                                                            <graphic>
                                                                                <SVGPath content="M14,2L20,8V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V4A2,2 0 0,1 6,2H14M18,20V9H13V4H6V20H18M10.92,12.31C10.89,12.5 10.82,12.68 10.7,12.85L11.28,13.42L8.99,15.7L8.42,15.13C8.25,15.25 8.07,15.32 7.88,15.35C7.69,15.38 7.5,15.36 7.31,15.29C7.13,15.21 6.96,15.09 6.82,14.94L6.4,14.5C6.25,14.35 6.15,14.19 6.08,14C6,13.83 5.97,13.64 6,13.45C6.03,13.26 6.1,13.08 6.21,12.91L9.5,9.61C9.66,9.5 9.84,9.43 10.03,9.4C10.22,9.37 10.41,9.39 10.6,9.46C10.79,9.54 10.95,9.66 11.1,9.81L11.5,10.23C11.66,10.38 11.76,10.55 11.83,10.74C11.9,10.92 11.93,11.11 11.9,11.31M9.75,13.96L11.33,12.37L9.12,10.16L7.54,11.74L9.75,13.96M13,11.25H19V12.75H13V11.25Z" fill="white" />
                                                                            </graphic>
                                                                        </Button>
                                                                    </children>
                                                                    <padding>
                                                                        <Insets top="10.0" />
                                                                    </padding>
                                                                </HBox>
                                                            </children>
                                                            <padding>
                                                                <Insets bottom="15.0" left="15.0" right="15.0" top="15.0" />
                                                            </padding>
                                                        </VBox>
                                                    </content>

                                                </ScrollPane>
                                            </children>
                                        </StackPane>
                                    </left>
                                    <center>
                                        <StackPane>
                                            <children>
                                                <!-- Right Panel with Form -->
                                                <ScrollPane fx:id="formScrollPane" fitToHeight="true" fitToWidth="true" pannable="true" styleClass="form-scroll-pane" BorderPane.alignment="CENTER">
                                                    <padding>
                                                        <Insets top="30.0" /> <!-- Increased top padding to push content down -->
                                                    </padding>
                                                    <content>
                                                        <VBox spacing="15.0" styleClass="paiement-form">
                                                            <children>
                                                                <!-- Payment Header -->
                                                                <HBox alignment="CENTER_LEFT" spacing="20" styleClass="paiement-header">
                                                                    <!-- Payment Icon -->
                                                                    <StackPane styleClass="payment-icon">
                                                                        <SVGPath content="M5,6H23V18H5V6M14,9A3,3 0 0,1 17,12A3,3 0 0,1 14,15A3,3 0 0,1 11,12A3,3 0 0,1 14,9M9,8A2,2 0 0,1 7,10V14A2,2 0 0,1 9,16H19A2,2 0 0,1 21,14V10A2,2 0 0,1 19,8H9M1,10H3V20H19V22H1V10Z" fill="#2563eb" scaleX="1.5" scaleY="1.5" />
                                                                    </StackPane>

                                                                    <!-- Payment Information -->
                                                                    <VBox spacing="5">
                                                                        <Label styleClass="section-label" text="Détails du Paiement" />
                                                                        <HBox alignment="CENTER_LEFT" spacing="10">
                                                                            <Label fx:id="paymentStatusBadge" styleClass="payment-status-badge" text="Nouveau paiement" />
                                                                        </HBox>
                                                                    </VBox>
                                                                </HBox>

                                                                <!-- Candidat Selection -->
                                                                <TitledPane animated="true" expanded="true" text="Informations du paiement">
                                                                    <content>
                                                                        <GridPane hgap="15.0" vgap="15.0">
                                                                            <columnConstraints>
                                                                                <ColumnConstraints hgrow="SOMETIMES" maxWidth="150.0" minWidth="120.0" prefWidth="120.0" />
                                                                                <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="250.0" />
                                                                                <ColumnConstraints hgrow="SOMETIMES" maxWidth="150.0" minWidth="120.0" prefWidth="120.0" />
                                                                                <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="250.0" />
                                                                            </columnConstraints>
                                                                            <rowConstraints>
                                                                                <RowConstraints minHeight="40.0" prefHeight="40.0" vgrow="SOMETIMES" />
                                                                                <RowConstraints minHeight="40.0" prefHeight="40.0" vgrow="SOMETIMES" />
                                                                                <RowConstraints minHeight="40.0" prefHeight="40.0" vgrow="SOMETIMES" />
                                                                                <RowConstraints minHeight="40.0" prefHeight="40.0" vgrow="SOMETIMES" />
                                                                            </rowConstraints>
                                                                            <children>
                                                                                <!-- First row -->
                                                                                <Label styleClass="form-label" text="Candidat:" />
                                                                                <ComboBox fx:id="candidatComboBox" prefWidth="250.0" styleClass="combo-box-large" GridPane.columnIndex="1" />

                                                                                <Label styleClass="form-label" text="Type de paiement:" GridPane.columnIndex="2" />
                                                                                <HBox alignment="CENTER_LEFT" spacing="20.0" GridPane.columnIndex="3">
                                                                                    <children>
                                                                                        <RadioButton fx:id="paiementCompletRadio" mnemonicParsing="false" styleClass="radio-button-large" text="Complet" />
                                                                                        <RadioButton fx:id="paiementPartielRadio" mnemonicParsing="false" styleClass="radio-button-large" text="Partiel" />
                                                                                    </children>
                                                                                </HBox>

                                                                                <!-- Second row -->
                                                                                <Label styleClass="form-label" text="Date:" GridPane.rowIndex="1" />
                                                                                <DatePicker fx:id="datePaiementPicker" styleClass="date-picker-large" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                                                                                <Label fx:id="montantLabel" styleClass="form-label" text="Montant (DT):" visible="false" GridPane.columnIndex="2" GridPane.rowIndex="1" />
                                                                                <HBox alignment="CENTER_LEFT" spacing="10" GridPane.columnIndex="3" GridPane.rowIndex="1">
                                                                                    <TextField fx:id="montantField" styleClass="text-field-large" visible="false" HBox.hgrow="ALWAYS" />
                                                                                    <Label fx:id="maxMontantLabel" text="(Max: 0.00 DT)" visible="false" />
                                                                                </HBox>

                                                                                <!-- Third row -->
                                                                                <Label styleClass="form-label" text="Référence:" GridPane.rowIndex="2" />
                                                                                <HBox alignment="CENTER_LEFT" spacing="10.0" GridPane.columnIndex="1" GridPane.rowIndex="2">
                                                                                    <TextField fx:id="referenceField" styleClass="text-field-large" HBox.hgrow="ALWAYS" />
                                                                                    <Button fx:id="genererReferenceBtn" mnemonicParsing="false" onAction="#handleGenererReference" styleClass="button, button-secondary" text="Générer" />
                                                                                </HBox>

                                                                                <Label styleClass="form-label" text="Méthode de paiement:" GridPane.columnIndex="2" GridPane.rowIndex="2" />
                                                                                <ComboBox fx:id="methodePaiementComboBox" styleClass="combo-box-large" GridPane.columnIndex="3" GridPane.rowIndex="2" />


                                                                                <!-- Ajout du ComboBox statut qui manquait et causait l'erreur -->
                                                                                <Label styleClass="form-label" text="Statut:" visible="false" GridPane.columnIndex="2" GridPane.rowIndex="3" />
                                                                                <ComboBox fx:id="statutComboBox" styleClass="combo-box-large" visible="false" GridPane.columnIndex="3" GridPane.rowIndex="3" />
                                                                            </children>
                                                                            <padding>
                                                                                <Insets bottom="15.0" left="15.0" right="15.0" top="15.0" />
                                                                            </padding>
                                                                        </GridPane>
                                                                    </content>
                                                                </TitledPane>

                                                                <!-- Payment Progress -->
                                                                <TitledPane animated="true" expanded="false" text="Progression du paiement">
                                                                    <content>
                                                                        <VBox spacing="15.0">
                                                                            <ProgressBar fx:id="paiementProgressBar" prefWidth="Infinity" progress="0.0" styleClass="progress-bar-large" />
                                                                            <HBox alignment="CENTER" spacing="20.0">
                                                                                <Label fx:id="totalDuLabel" styleClass="payment-info-label" text="Total dû: 0.00 DT" />
                                                                                <Label fx:id="totalPayeLabel" styleClass="payment-info-label" text="Total payé: 0.00  DT" />
                                                                                <Label fx:id="resteAPayerLabel" styleClass="payment-info-label" text="Reste à payer: 0.00 DT" />
                                                                            </HBox>
                                                                            <padding>
                                                                                <Insets bottom="15.0" left="15.0" right="15.0" top="15.0" />
                                                                            </padding>
                                                                        </VBox>
                                                                    </content>
                                                                </TitledPane>

                                                                <!-- Form Buttons -->
                                                                <HBox alignment="CENTER_RIGHT" spacing="20.0">
                                                                    <children>
                                                                        <Button fx:id="paiementAnnulerBtn" mnemonicParsing="false" onAction="#handleAnnuler" styleClass="button, button-secondary" text="Annuler">
                                                                            <graphic>
                                                                                <SVGPath content="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" fill="white" />
                                                                            </graphic>
                                                                        </Button>
                                                                        <Button fx:id="paiementEnregistrerBtn" mnemonicParsing="false" onAction="#handleEnregistrer" styleClass="button, button-primary" text="Enregistrer">
                                                                            <graphic>
                                                                                <SVGPath content="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z" fill="white" />
                                                                            </graphic>
                                                                        </Button>
                                                                    </children>
                                                                    <padding>
                                                                        <Insets top="15.0" />
                                                                    </padding>
                                                                </HBox>
                                                            </children>
                                                            <padding>
                                                                <Insets bottom="15.0" left="15.0" right="15.0" top="15.0" />
                                                            </padding>
                                                        </VBox>
                                                    </content>
                                                </ScrollPane>
                                            </children>
                                        </StackPane>
                                    </center>
                                </BorderPane>
                            </content>
                        </Tab>

                        <!-- Depense Tab -->
                        <Tab fx:id="depenseTab" text="Dépenses">
                            <content>
                                <BorderPane>
                                    <left>
                                        <!-- Left Panel with Table and Actions -->
                                        <ScrollPane fitToHeight="true" styleClass="left-panel-scroll">
                                            <content>
                                                <VBox prefHeight="600" prefWidth="450.0" spacing="15.0" styleClass="paiement-table-container" >
                                                    <children>
                                                        <!-- Search Bar -->
                                                        <HBox alignment="CENTER_LEFT" spacing="15.0">
                                                            <children>
                                                                <TextField fx:id="depenseRechercheField" promptText="Rechercher par catégorie, description..." styleClass="search-box" HBox.hgrow="ALWAYS" onKeyReleased="#handleRecherche"/>
                                                                <Button fx:id="depenseRechercheBtn" mnemonicParsing="false" onAction="#handleRecherche" styleClass="icon-button">
                                                                    <tooltip>
                                                                        <Tooltip text="Rechercher" />
                                                                    </tooltip>
                                                                    <graphic>
                                                                        <SVGPath content="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" fill="#2563eb" />
                                                                    </graphic>
                                                                </Button>
                                                            </children>
                                                        </HBox>

                                                        <!-- Depense Table -->
                                                        <TableView fx:id="depenseTable"  styleClass="table-view-large" VBox.vgrow="ALWAYS">
                                                            <columns>
                                                                <TableColumn fx:id="depenseIdColumn" prefWidth="50.0" text="ID" />
                                                                <TableColumn fx:id="categorieColumn" prefWidth="100.0" text="Catégorie" />
                                                                <TableColumn fx:id="montantDepenseColumn" prefWidth="80.0" text="Montant" />
                                                                <TableColumn fx:id="dateDepenseColumn" prefWidth="80.0" text="Date" />
                                                                <TableColumn fx:id="descriptionColumn" prefWidth="120.0" text="Description" />
                                                                <TableColumn fx:id="vehiculeColumn" prefWidth="100.0" text="Véhicule" />
                                                                <TableColumn fx:id="moniteurColumn" prefWidth="100.0" text="Moniteur" />
                                                            </columns>
                                                            <placeholder>
                                                                <Label styleClass="placeholder-label" text="Aucune dépense trouvée" />
                                                            </placeholder>
                                                        </TableView>

                                                        <!-- Action Buttons -->
                                                        <HBox alignment="CENTER" spacing="10.0">
                                                            <children>
                                                                <Button fx:id="depenseAjouterBtn" mnemonicParsing="false" onAction="#handleAjouter" styleClass="button, button-success" text="Ajouter">
                                                                    <graphic>
                                                                        <SVGPath content="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" fill="white" />
                                                                    </graphic>
                                                                </Button>
                                                                <Button fx:id="depenseModifierBtn" mnemonicParsing="false" onAction="#handleModifier" styleClass="button, button-warning" text="Modifier">
                                                                    <graphic>
                                                                        <SVGPath content="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" fill="white" />
                                                                    </graphic>
                                                                </Button>
                                                                <Button fx:id="depenseSupprimerBtn" mnemonicParsing="false" onAction="#handleSupprimer" styleClass="button, button-danger" text="Supprimer">
                                                                    <graphic>
                                                                        <SVGPath content="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" fill="white" />
                                                                    </graphic>
                                                                </Button>
                                                            </children>
                                                        </HBox>
                                                        <HBox alignment="CENTER" spacing="10.0">
                                                            <children>
                                                                <Button fx:id="generateDepensePdfBtn" maxWidth="Infinity" mnemonicParsing="false" onAction="#handleGenerateDepensePdf" styleClass="button, button-primary" text="Générer PDF" HBox.hgrow="ALWAYS">
                                                                    <graphic>
                                                                        <SVGPath content="M14,2L20,8V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V4A2,2 0 0,1 6,2H14M18,20V9H13V4H6V20H18M10.92,12.31C10.89,12.5 10.82,12.68 10.7,12.85L11.28,13.42L8.99,15.7L8.42,15.13C8.25,15.25 8.07,15.32 7.88,15.35C7.69,15.38 7.5,15.36 7.31,15.29C7.13,15.21 6.96,15.09 6.82,14.94L6.4,14.5C6.25,14.35 6.15,14.19 6.08,14C6,13.83 5.97,13.64 6,13.45C6.03,13.26 6.1,13.08 6.21,12.91L9.5,9.61C9.66,9.5 9.84,9.43 10.03,9.4C10.22,9.37 10.41,9.39 10.6,9.46C10.79,9.54 10.95,9.66 11.1,9.81L11.5,10.23C11.66,10.38 11.76,10.55 11.83,10.74C11.9,10.92 11.93,11.11 11.9,11.31M9.75,13.96L11.33,12.37L9.12,10.16L7.54,11.74L9.75,13.96M13,11.25H19V12.75H13V11.25Z" fill="white" />
                                                                    </graphic>
                                                                </Button>
                                                            </children>
                                                            <padding>
                                                                <Insets top="10.0" />
                                                            </padding>
                                                        </HBox>
                                                    </children>
                                                    <padding>
                                                        <Insets bottom="15.0" left="15.0" right="15.0" top="15.0" />
                                                    </padding>
                                                </VBox>
                                            </content>
                                        </ScrollPane>
                                    </left>
                                    <center>
                                        <!-- Right Panel with Form -->
                                        <ScrollPane fitToWidth="true" styleClass="form-content-scroll">
                                            <padding>
                                                <Insets top="30.0" /> <!-- Increased top padding to push content down -->
                                            </padding>
                                            <content>
                                                <VBox spacing="15.0" styleClass="paiement-form">
                                                    <children>
                                                        <!-- Depense Header -->
                                                        <HBox alignment="CENTER_LEFT" spacing="20" styleClass="paiement-header">
                                                            <!-- Depense Icon -->
                                                            <StackPane styleClass="payment-icon">
                                                                <SVGPath content="M11.8,10.9C9.53,10.31 8.8,9.7 8.8,8.75C8.8,7.66 9.81,6.9 11.5,6.9C13.28,6.9 13.94,7.75 14,9H16.21C16.14,7.28 15.09,5.7 13,5.19V3H10V5.16C8.06,5.58 6.5,6.84 6.5,8.77C6.5,11.08 8.41,12.23 11.2,12.9C13.7,13.5 14.2,14.38 14.2,15.31C14.2,16 13.71,17.1 11.5,17.1C9.44,17.1 8.63,16.18 8.5,15H6.32C6.44,17.19 8.08,18.42 10,18.83V21H13V18.85C14.95,18.5 16.5,17.35 16.5,15.3C16.5,12.46 14.07,11.5 11.8,10.9Z" fill="#2563eb" scaleX="1.5" scaleY="1.5" />
                                                            </StackPane>

                                                            <!-- Depense Information -->
                                                            <VBox spacing="5">
                                                                <Label styleClass="section-label" text="Détails de la Dépense" />
                                                            </VBox>
                                                        </HBox>

                                                        <!-- Depense Information -->
                                                        <TitledPane animated="true" expanded="true" text="Informations de la dépense">
                                                            <content>
                                                                <GridPane hgap="20.0" vgap="40.0">
                                                                    <columnConstraints>
                                                                        <ColumnConstraints hgrow="SOMETIMES" maxWidth="150.0" minWidth="120.0" prefWidth="120.0" />
                                                                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="250.0" />
                                                                        <ColumnConstraints hgrow="SOMETIMES" maxWidth="150.0" minWidth="120.0" prefWidth="120.0" />
                                                                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="250.0" />
                                                                    </columnConstraints>
                                                                    <rowConstraints>
                                                                        <RowConstraints minHeight="50.0" prefHeight="50.0" vgrow="SOMETIMES" />
                                                                        <RowConstraints minHeight="100.0" prefHeight="100.0" vgrow="SOMETIMES" />
                                                                        <RowConstraints minHeight="80.0" prefHeight="80.0" vgrow="SOMETIMES" />
                                                                    </rowConstraints>
                                                                    <children>
                                                                        <!-- First row - Fixed fields -->
                                                                        <Label styleClass="form-label" text="Catégorie:" />
                                                                        <ComboBox fx:id="categorieComboBox" prefWidth="250.0" styleClass="combo-box-large" GridPane.columnIndex="1" />

                                                                        <Label styleClass="form-label" text="Date:" GridPane.columnIndex="2" />
                                                                        <DatePicker fx:id="dateDepensePicker" prefWidth="250.0" styleClass="date-picker-large" GridPane.columnIndex="3" />

                                                                        <!-- Second row - Montant and category-specific containers -->
                                                                        <Label styleClass="form-label" text="Montant (DT):" GridPane.rowIndex="1" />
                                                                        <TextField fx:id="montantDepenseField" prefWidth="250.0" styleClass="text-field-large" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                                                                        <!-- Moniteur container -->
                                                                        <GridPane fx:id="moniteurContainer" hgap="20" vgap="20" visible="false" GridPane.columnIndex="2" GridPane.columnSpan="2" GridPane.rowIndex="1">
                                                                            <columnConstraints>
                                                                                <ColumnConstraints hgrow="SOMETIMES" minWidth="100.0" prefWidth="120.0" />
                                                                                <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="250.0" />
                                                                            </columnConstraints>
                                                                            <rowConstraints>
                                                                                <RowConstraints minHeight="45.0" prefHeight="45.0" vgrow="SOMETIMES" />
                                                                            </rowConstraints>
                                                                            <children>
                                                                                <Label styleClass="form-label" text="Moniteur:" />
                                                                                <ComboBox fx:id="moniteurComboBox" prefWidth="250.0" styleClass="combo-box-large" GridPane.columnIndex="1" />
                                                                            </children>
                                                                        </GridPane>

                                                                        <!-- Vehicule container -->
                                                                        <VBox fx:id="vehiculeContainer" spacing="30" visible="false" GridPane.columnIndex="2" GridPane.columnSpan="2" GridPane.rowIndex="1">
                                                                            <GridPane hgap="20" vgap="20">
                                                                                <columnConstraints>
                                                                                    <ColumnConstraints hgrow="SOMETIMES" minWidth="100.0" prefWidth="120.0" />
                                                                                    <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="250.0" />
                                                                                </columnConstraints>
                                                                                <rowConstraints>
                                                                                    <RowConstraints minHeight="45.0" prefHeight="45.0" vgrow="SOMETIMES" />
                                                                                </rowConstraints>
                                                                                <children>
                                                                                    <Label styleClass="form-label" text="Véhicule:" />
                                                                                    <ComboBox fx:id="vehiculeComboBox" prefWidth="250.0" styleClass="combo-box-large" GridPane.columnIndex="1" />
                                                                                </children>
                                                                            </GridPane>

                                                                            <GridPane hgap="20" vgap="20">
                                                                                <columnConstraints>
                                                                                    <ColumnConstraints hgrow="SOMETIMES" minWidth="100.0" prefWidth="120.0" />
                                                                                    <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="250.0" />
                                                                                </columnConstraints>
                                                                                <rowConstraints>
                                                                                    <RowConstraints minHeight="45.0" prefHeight="45.0" vgrow="SOMETIMES" />
                                                                                </rowConstraints>
                                                                                <children>
                                                                                    <Label styleClass="form-label" text="Type:" />
                                                                                    <ComboBox fx:id="typeVehiculeDepenseComboBox" prefWidth="250.0" styleClass="combo-box-large" GridPane.columnIndex="1" />
                                                                                </children>
                                                                            </GridPane>
                                                                        </VBox>

                                                                        <!-- Reparation container - positioned directly under vehicule container -->
                                                                        <GridPane fx:id="reparationContainer" hgap="20" vgap="20" visible="false" GridPane.columnIndex="2" GridPane.columnSpan="2" GridPane.rowIndex="2">
                                                                            <columnConstraints>
                                                                                <ColumnConstraints hgrow="SOMETIMES" minWidth="100.0" prefWidth="120.0" />
                                                                                <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="250.0" />
                                                                            </columnConstraints>
                                                                            <rowConstraints>
                                                                                <RowConstraints minHeight="45.0" prefHeight="45.0" vgrow="SOMETIMES" />
                                                                            </rowConstraints>
                                                                            <children>
                                                                                <Label styleClass="form-label" text="Réparation:" />
                                                                                <ComboBox fx:id="reparationComboBox" prefWidth="250.0" styleClass="combo-box-large" GridPane.columnIndex="1" />
                                                                            </children>
                                                                        </GridPane>

                                                                        <!-- Autres container - same position as moniteur -->
                                                                        <GridPane fx:id="autresContainer" hgap="20" vgap="20" visible="false" GridPane.columnIndex="2" GridPane.columnSpan="2" GridPane.rowIndex="1">
                                                                            <columnConstraints>
                                                                                <ColumnConstraints hgrow="SOMETIMES" minWidth="100.0" prefWidth="120.0" />
                                                                                <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="250.0" />
                                                                            </columnConstraints>
                                                                            <rowConstraints>
                                                                                <RowConstraints minHeight="45.0" prefHeight="45.0" vgrow="SOMETIMES" />
                                                                            </rowConstraints>
                                                                            <children>
                                                                                <Label styleClass="form-label" text="Type de dépense:" />
                                                                                <TextField fx:id="typeAutreDepenseField" prefWidth="250.0" styleClass="text-field-large" GridPane.columnIndex="1" />
                                                                            </children>
                                                                        </GridPane>

                                                                        <!-- Third row - Description -->
                                                                        <Label styleClass="form-label" text="Description:" GridPane.rowIndex="2" />
                                                                        <TextArea fx:id="descriptionField" styleClass="text-area-large" wrapText="true" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                                                                    </children>
                                                                    <padding>
                                                                        <Insets bottom="25.0" left="25.0" right="25.0" top="25.0" />
                                                                    </padding>
                                                                </GridPane>
                                                            </content>
                                                        </TitledPane>
                                                        <!-- Form Buttons -->
                                                        <HBox alignment="CENTER_RIGHT" spacing="20.0">
                                                            <children>

                                                                <Button fx:id="depenseAnnulerBtn" mnemonicParsing="false" onAction="#handleAnnuler" styleClass="button, button-secondary" text="Annuler">
                                                                    <graphic>
                                                                        <SVGPath content="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" fill="white" />
                                                                    </graphic>
                                                                </Button>
                                                                <Button fx:id="depenseEnregistrerBtn" mnemonicParsing="false" onAction="#handleEnregistrer" styleClass="button, button-primary" text="Enregistrer">
                                                                    <graphic>
                                                                        <SVGPath content="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z" fill="white" />
                                                                    </graphic>
                                                                </Button>
                                                            </children>
                                                            <padding>
                                                                <Insets top="15.0" />
                                                            </padding>
                                                        </HBox>
                                                    </children>
                                                    <padding>
                                                        <Insets bottom="15.0" left="15.0" right="15.0" top="15.0" />
                                                    </padding>
                                                </VBox>
                                            </content>
                                        </ScrollPane>
                                    </center>
                                </BorderPane>
                            </content>
                        </Tab>

                        <!-- Tarif Tab -->
                        <Tab fx:id="tarifTab" text="Tarifs">
                            <content>
                                <BorderPane>
                                    <left>
                                        <!-- Left Panel with Table and Actions -->
                                        <ScrollPane fitToHeight="true" styleClass="left-panel-scroll">
                                            <content>
                                                <VBox prefHeight="600" prefWidth="450.0" spacing="15.0" styleClass="paiement-table-container">
                                                    <children>
                                                        <!-- Search Bar -->
                                                        <HBox alignment="CENTER_LEFT" spacing="15.0">
                                                            <children>
                                                                <TextField fx:id="tarifRechercheField" promptText="Rechercher par type de service, description..." styleClass="search-box" HBox.hgrow="ALWAYS" onKeyReleased="#handleRecherche"/>
                                                                <Button fx:id="tarifRechercheBtn" mnemonicParsing="false" onAction="#handleRecherche" styleClass="icon-button">
                                                                    <tooltip>
                                                                        <Tooltip text="Rechercher" />
                                                                    </tooltip>
                                                                    <graphic>
                                                                        <SVGPath content="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" fill="#2563eb" />
                                                                    </graphic>
                                                                </Button>
                                                            </children>
                                                        </HBox>

                                                        <!-- Tarif Table -->
                                                        <TableView fx:id="tarifTable" prefHeight="350.0" styleClass="table-view-large">
                                                            <columns>
                                                                <TableColumn fx:id="tarifIdColumn" prefWidth="50.0" text="ID" />
                                                                <TableColumn fx:id="typeServiceTarifColumn" prefWidth="120.0" text="Type de Service" />
                                                                <TableColumn fx:id="montantTarifColumn" prefWidth="80.0" text="Montant" />
                                                                <TableColumn fx:id="descriptionTarifColumn" prefWidth="150.0" text="Description" />
                                                            </columns>
                                                            <placeholder>
                                                                <Label styleClass="placeholder-label" text="Aucun tarif trouvé" />
                                                            </placeholder>
                                                        </TableView>

                                                        <!-- Action Buttons -->
                                                        <HBox alignment="CENTER" spacing="10.0">
                                                            <children>
                                                                <Button fx:id="tarifModifierBtn" mnemonicParsing="false" onAction="#handleModifier" styleClass="button, button-warning" text="Modifier">
                                                                    <graphic>
                                                                        <SVGPath content="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" fill="white" />
                                                                    </graphic>
                                                                </Button>
                                                            </children>
                                                        </HBox>
                                                    </children>
                                                    <padding>
                                                        <Insets bottom="15.0" left="15.0" right="15.0" top="15.0" />
                                                    </padding>
                                                </VBox>
                                            </content>
                                        </ScrollPane>
                                    </left>
                                    <center>
                                        <!-- Right Panel with Form -->
                                        <ScrollPane fitToWidth="true" styleClass="form-content-scroll">
                                            <padding>
                                                <Insets top="30.0" /> <!-- Increased top padding to push content down -->
                                            </padding>
                                            <content>
                                                <VBox spacing="15.0" styleClass="paiement-form">
                                                    <children>
                                                        <!-- Tarif Header -->
                                                        <HBox alignment="CENTER_LEFT" spacing="20" styleClass="paiement-header">
                                                            <!-- Tarif Icon -->
                                                            <StackPane styleClass="payment-icon">
                                                                <SVGPath content="M7,15H9C9,16.08 10.37,17 12,17C13.63,17 15,16.08 15,15C15,13.9 13.96,13.5 11.76,12.97C9.64,12.44 7,11.78 7,9C7,7.21 8.47,5.69 10.5,5.18V3H13.5V5.18C15.53,5.69 17,7.21 17,9H15C15,7.92 13.63,7 12,7C10.37,7 9,7.92 9,9C9,10.1 10.04,10.5 12.24,11.03C14.36,11.56 17,12.22 17,15C17,16.79 15.53,18.31 13.5,18.82V21H10.5V18.82C8.47,18.31 7,16.79 7,15Z" fill="#2563eb" scaleX="1.5" scaleY="1.5" />
                                                            </StackPane>

                                                            <!-- Tarif Information -->
                                                            <VBox spacing="5">
                                                                <Label styleClass="section-label" text="Détails du Tarif" />
                                                            </VBox>
                                                        </HBox>

                                                        <!-- Tarif Information -->
                                                        <TitledPane animated="true" expanded="true" text="Informations du tarif">
                                                            <content>
                                                                <GridPane hgap="15.0" vgap="15.0">
                                                                    <columnConstraints>
                                                                        <ColumnConstraints hgrow="SOMETIMES" maxWidth="150.0" minWidth="120.0" prefWidth="120.0" />
                                                                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="250.0" />
                                                                        <ColumnConstraints hgrow="SOMETIMES" maxWidth="150.0" minWidth="120.0" prefWidth="120.0" />
                                                                        <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="250.0" />
                                                                    </columnConstraints>
                                                                    <rowConstraints>
                                                                        <RowConstraints minHeight="40.0" prefHeight="40.0" vgrow="SOMETIMES" />
                                                                        <RowConstraints minHeight="40.0" prefHeight="40.0" vgrow="SOMETIMES" />
                                                                        <RowConstraints minHeight="80.0" prefHeight="80.0" vgrow="SOMETIMES" />
                                                                    </rowConstraints>
                                                                    <children>
                                                                        <!-- First row -->
                                                                        <Label styleClass="form-label" text="Type de Service:" />
                                                                        <ComboBox fx:id="typeServiceTarifComboBox" prefWidth="250.0" styleClass="combo-box-large" GridPane.columnIndex="1" />

                                                                        <!-- Second row -->
                                                                        <Label styleClass="form-label" text="Montant (DT):" GridPane.rowIndex="1" />
                                                                        <TextField fx:id="montantTarifField" styleClass="text-field-large" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                                                                        <!-- Third row -->
                                                                        <Label styleClass="form-label" text="Description:" GridPane.rowIndex="2" />
                                                                        <TextArea fx:id="descriptionTarifField" styleClass="text-area-large" wrapText="true" GridPane.columnIndex="1" GridPane.columnSpan="3" GridPane.rowIndex="2" />
                                                                    </children>
                                                                    <padding>
                                                                        <Insets bottom="15.0" left="15.0" right="15.0" top="15.0" />
                                                                    </padding>
                                                                </GridPane>
                                                            </content>
                                                        </TitledPane>

                                                        <!-- Form Buttons -->
                                                        <HBox alignment="CENTER_RIGHT" spacing="20.0">
                                                            <children>
                                                                <Button fx:id="tarifAnnulerBtn" mnemonicParsing="false" onAction="#handleAnnuler" styleClass="button, button-secondary" text="Annuler">
                                                                    <graphic>
                                                                        <SVGPath content="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" fill="white" />
                                                                    </graphic>
                                                                </Button>
                                                                <Button fx:id="tarifEnregistrerBtn" mnemonicParsing="false" onAction="#handleEnregistrer" styleClass="button, button-primary" text="Enregistrer">
                                                                    <graphic>
                                                                        <SVGPath content="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z" fill="white" />
                                                                    </graphic>
                                                                </Button>
                                                            </children>
                                                            <padding>
                                                                <Insets top="15.0" />
                                                            </padding>
                                                        </HBox>
                                                    </children>
                                                    <padding>
                                                        <Insets bottom="15.0" left="15.0" right="15.0" top="15.0" />
                                                    </padding>
                                                </VBox>
                                            </content>
                                        </ScrollPane>
                                    </center>
                                </BorderPane>
                            </content>
                        </Tab>
                    </tabs>
                </TabPane>


                <!-- Dashboard Panel -->
                <VBox fx:id="dashboardPane" spacing="20.0" styleClass="dashboard-container" visible="false">
                    <padding>
                        <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                    </padding>

                    <!-- Dashboard Header -->
                    <HBox alignment="CENTER_LEFT" spacing="20" styleClass="paiement-header">
                        <StackPane styleClass="dashboard-icon">
                            <SVGPath content="M3,11H11V3H3M3,21H11V13H3M13,21H21V13H13M13,3V11H21V3" fill="white" scaleX="1.5" scaleY="1.5" />
                        </StackPane>
                        <Label styleClass="section-label" text="Tableau de Bord Financier" />
                    </HBox>

                    <!-- Stats Cards -->
                    <HBox alignment="CENTER" spacing="20">
                        <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                            <Label styleClass="stat-title" text="Total Revenus" />
                            <Label fx:id="totalRevenusLabel" styleClass="stat-value" text="0.00 DT" />
                        </VBox>

                        <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                            <Label styleClass="stat-title" text="Total Dépenses" />
                            <Label fx:id="totalDepensesLabel" styleClass="stat-value" text="0.00 DT" />
                        </VBox>

                        <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                            <Label styleClass="stat-title" text="Bénéfice Net" />
                            <Label fx:id="beneficeNetLabel" styleClass="stat-value" text="0.00 DT" />
                        </VBox>

                        <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                            <Label styleClass="stat-title" text="Taux de Rentabilité" />
                            <Label fx:id="tauxRentabiliteLabel" styleClass="stat-value" text="0.00%" />
                        </VBox>
                    </HBox>

                    <!-- Charts -->
                    <HBox spacing="20" VBox.vgrow="ALWAYS">
                        <VBox spacing="10" styleClass="chart-container" HBox.hgrow="ALWAYS">
                            <Label styleClass="chart-title" text="Revenus par Type" />
                            <PieChart fx:id="revenusByTypeChart" legendVisible="true" VBox.vgrow="ALWAYS" />
                        </VBox>

                        <VBox spacing="10" styleClass="chart-container" HBox.hgrow="ALWAYS">
                            <Label styleClass="chart-title" text="Dépenses par Catégorie" />
                            <PieChart fx:id="depensesByCategorieChart" legendVisible="true" VBox.vgrow="ALWAYS" />
                        </VBox>
                    </HBox>

                    <HBox spacing="20" VBox.vgrow="ALWAYS">
                        <VBox spacing="10" styleClass="chart-container" HBox.hgrow="ALWAYS">
                            <Label styleClass="chart-title" text="Revenus et Dépenses Mensuels" />
                            <BarChart fx:id="revenusDepensesMensuelChart" legendVisible="true" VBox.vgrow="ALWAYS">
                                <xAxis>
                                    <CategoryAxis label="Mois" />
                                </xAxis>
                                <yAxis>
                                    <NumberAxis label="Montant (DT)" />
                                </yAxis>
                            </BarChart>
                        </VBox>

                        <VBox spacing="10" styleClass="chart-container" HBox.hgrow="ALWAYS">
                            <Label styleClass="chart-title" text="Méthodes de Paiement" />
                            <PieChart fx:id="methodePaiementChart" legendVisible="true" VBox.vgrow="ALWAYS" />
                        </VBox>
                    </HBox>

                    <!-- Refresh Button -->
                    <HBox alignment="CENTER_RIGHT" spacing="15.0">
                        <Button fx:id="refreshDashboardBtn" mnemonicParsing="false" styleClass="button, button-info" text="Actualiser">
                            <graphic>
                                <SVGPath content="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z" fill="white" />
                            </graphic>
                        </Button>
                    </HBox>
                </VBox>
            </children>
        </StackPane>
    </center>
    <padding>
        <Insets top="10.0" />
    </padding>
</BorderPane>
